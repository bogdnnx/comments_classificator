<!DOCTYPE html>
<html>
<head>
    <title>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã: {{ query }}</title>
    <style>
        body { font-family: Arial; margin: 0; padding: 20px; background: #f5f5f5; }
        .header { text-align: center; margin-bottom: 20px; padding: 15px; background: white; border-radius: 8px; }
        .summary { font-size: 18px; font-weight: bold; }
        .positive { color: #2e7d32; }
        .negative { color: #c62828; }
        .neutral { color: ##6c757d; }
        .container { display: flex; gap: 20px; height: calc(100vh - 200px); }
        .column { background: white; border-radius: 8px; padding: 15px; overflow-y: auto; }
        .posts-column { width: 35%; }
        .comments-column { width: 65%; }
        .post-item { border-bottom: 1px solid #eee; padding: 10px 0; }
        .post-link { color: #1976d2; text-decoration: none; font-weight: bold; }
        .post-link:hover { text-decoration: underline; }
        .comment-item { border: 1px solid #eee; border-radius: 6px; padding: 10px; margin-bottom: 10px; }
        .sentiment-positive { border-left: 4px solid #4caf50; }
        .sentiment-negative { border-left: 4px solid #f44336; }
        .back { display: inline-block; margin-top: 20px; padding: 8px 16px; background: #1976d2; color: white; text-decoration: none; border-radius: 4px; }
    </style>
</head>
<body>

<div class="header">
    <h1>üîé –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞: "{{ query }}"</h1>
    <div class="summary">
        –í—Å–µ–≥–æ: <strong>{{ summary.total }}</strong> |
        –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ: <span class="positive">{{ summary.positive }}</span> |
        –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ: <span class="negative">{{ summary.negative }}</span>
    </div>
</div>

<div class="container">
    <div class="column posts-column">
        <h2>üìÑ –ü–æ—Å—Ç—ã ({{ posts|length }})</h2>
        {% for post in posts %}
        <div class="post-item">
            <a href="{{ post.url }}" target="_blank" class="post-link">–ü–æ—Å—Ç #{{ loop.index }}</a>
            <p>{{ post.text[:100] }}{% if post.text|length > 100 %}...{% endif %}</p>
            <small>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤: {{ comments_by_post.get(post.id, [])|length }}</small>
        </div>
        {% endfor %}
    </div>

    <div class="column comments-column">
        <h2>üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ({{ all_comments|length }})</h2>
        {% for comment in all_comments %}
        <div class="comment-item
            {% if comment.sentiment == 'positive' %}
                sentiment-positive
            {% elif comment.sentiment == 'negative' %}
                sentiment-negative
            {% elif comment.sentiment == 'neutral' %}
                sentiment-neutral
            {% endif %}">
            <div><strong>[{{ comment.sentiment }}]</strong> {{ comment.text }}</div>
            <div style="font-size:12px; color:#666;">
                –ê–≤—Ç–æ—Ä: {{ comment.from_id }} |
                –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {{ "%.2f"|format(comment.sentiment_confidence) }} |
                <a href="{% for p in posts %}{% if p.id == comment.post_id %}{{ p.url }}{% endif %}{% endfor %}" target="_blank">–ö –ø–æ—Å—Ç—É</a>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<a href="/" class="back">‚Üê –ù–æ–≤—ã–π –ø–æ–∏—Å–∫</a>

</body>
</html>